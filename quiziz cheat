// grabs answer from the application in session storage. 
//destroy quizizz!
class Encoding{static encodeRaw(t,n,r="quizizz.com"){let o=0;o=n?r.charCodeAt(0):r.charCodeAt(0)+r.charCodeAt(r.length-1);let a=[];for(let n=0;n<t.length;n++){let r=t[n].charCodeAt(0),o=e?this.safeAdd(r,s):this.addOffset(r,s,n,2);a.push(String.fromCharCode(o))}return a.join("")}static decode(e,t=!1){if(t){let t=this.extractHeader(e);return this.decodeRaw(t,!0)}{let t=this.decode(this.extractHeader(e),!0),n=this.extractData(e);return this.decodeRaw(n,!1,t)}}static decodeRaw(e,t,n="quizizz.com"){let r=this.extractVersion(e),o=0;o=-(o=t?n.charCodeAt(0):n.charCodeAt(0)+n.charCodeAt(n.length-1));let s=[];for(let n=0;n<e.length;n++){let a=e[n].charCodeAt(0),i=t?this.safeAdd(a,o):this.addOffset(a,o,n,r);s.push(String.fromCharCode(i))}return s.join("")}static addOffset(e,t,n,r){return 2===r?this.verifyCharCode(e)?this.safeAdd(e,n%2==0?t:-t):e:this.safeAdd(e,n%2==0?t:-t)}static extractData(e){let t=e.charCodeAt(e.length-2)-33;return e.slice(t,-2)}static extractHeader(e){let t=e.charCodeAt(e.length-2)-33;return e.slice(0,t)}static extractVersion(e){if("string"==typeof e&&e[e.length-1]){let t=parseInt(e[e.length-1],10);if(!isNaN(t))return t}return null}static safeAdd(e,t){let n=e+t;return n>65535?n-65535+0-1:n<0?65535-(0-n)+1:n}static verifyCharCode(e){if("number"==typeof e)return!(e>=55296&&e<=56319||e>=56320&&e<=57343)}}const globData={url:window.location.href,previousContext:JSON.parse(localStorage.getItem("previousContext"))};function GetSetData(){const{url:e,previousContext:t}=globData,n=t.game.roomHash,r={type:e.slice(e.search("gameType=")+9,e.length),roomHash:Encoding.decode(n.split("-")[1])},o=new XMLHttpRequest;return o.open("POST","https://game.quizizz.com/play-api/v3/getQuestions",!1),o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),o.send(JSON.stringify(r)),JSON.parse(o.responseText)}function GetCurrentQuestion(e){return e.questions[JSON.parse(localStorage.getItem("previousContext")).game.questionIdForQuestionStartTimestamp]}function*getRecursiveChildren(e){yield e;for(const t of e.children)for(const e of getRecursiveChildren(t))yield e}function*MatchDOM(e,t){const n="image"==e.type?e.media.map(function(e){return e.url}):"text"==e.type?e.text:null;console.log(`Searching for %c ${n}`,"color: lime;");for(const r of getRecursiveChildren(t))if("image"==e.type){let e=r.style["background-image"];if(null==e)continue;e=(e=e.slice(e.search(/\(/)+2,e.search(/\)/))).slice(0,e.search("\\?w"));for(const t of n)if(t==e){yield r;break}}else"text"==e.type&&r.innerHTML==e.text&&(yield r.parentElement)}function GetAnswer(e){return["MCQ","MSQ"].includes(e.type)?[JSON.parse(Encoding.decode(e.structure.answer))].flat().map(function(t){return e.structure.options[t]}).map(function(e){return[...MatchDOM(e,answerContainer)]}).flat():null}document.head.insertAdjacentHTML("beforeend","<style type=text/css>.good-option{color: lime !important;background : lime !important;}</style>");const dataset=GetSetData();let CurrentNum,LastRedemption,answerContainer=document.getElementsByClassName("options-container")[0].children[0],answers=[];function QuestionCheck(){answerContainer=document.getElementsByClassName("options-container")[0].children[0];document.getElementsByClassName("redemption-marker")[0];answers=GetAnswer(GetCurrentQuestion(dataset)),CurrentNum=document.getElementsByClassName("current-question")[0].innerHTML;for(const e of answers)e.classList.contains("good-option")||(console.log(`Got: ${e}`),e.innerHTML="<u>ESTAAA</u>",e.classList.add("good-option"),e.parentElement.classList.add("good-option"));answers=[]}let interv=setInterval(QuestionCheck,500);
